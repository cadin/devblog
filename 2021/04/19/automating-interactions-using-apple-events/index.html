<!DOCTYPE html>
<html lang='en'>

<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <meta name='viewport' content='width=device-width, initial-scale=1'>

  <title>Automating interactions using Apple Events ⌘I Get Info</title>
  <meta name='description' content="As I’ve previously mentioned, UltraPaint and artWORKS share a lot of DNA so their structure is effectively identical, including the tool palette. This is a g...">
  <link rel='canonical' href="https://blog.gingerbeardman.com/2021/04/19/automating-interactions-using-apple-events/">
  <link rel='alternate' type='application/rss+xml' title='⌘I' href="https://blog.gingerbeardman.com/feed.xml">

  <style>
    

    html{box-sizing:border-box}*,*:before,*:after{box-sizing:inherit}/*! normalize.css v5.0.0 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:0.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace, monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace, monospace;font-size:0.9em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,html [type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid #c0c0c0;margin:0 2px;padding:0.35em 0.625em 0.75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-cancel-button,[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}template{display:none}[hidden]{display:none}body,h1,h2,h3,h4,h5,h6,blockquote,p,pre,dl,dd,ol,ul,figure,hr,fieldset,legend{margin:0;padding:0}li>ol,li>ul{margin-bottom:0}table{border-collapse:collapse;border-spacing:0}address,h1,h2,h3,h4,h5,h6,blockquote,p,pre,dl,ol,ul,figure,hr,table,fieldset{margin-bottom:16px}dd,ol,ul{list-style-position:inside;margin-left:16px}@-webkit-keyframes spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.icon{position:relative;display:inline-block;width:25px;height:25px;overflow:hidden;fill:currentColor}.icon__cnt{width:100%;height:100%;background:inherit;fill:inherit;pointer-events:none;transform:translateX(0);-ms-transform:translate(0.5px, -0.3px)}.icon--m{width:50px;height:50px}.icon--l{width:100px;height:100px}.icon--xl{width:150px;height:150px}.icon--xxl{width:200px;height:200px}.icon__spinner{position:absolute;top:0;left:0;width:100%;height:100%}.icon--ei-spinner .icon__spinner,.icon--ei-spinner-2 .icon__spinner{-webkit-animation:spin 1s steps(12) infinite;animation:spin 1s steps(12) infinite}.icon--ei-spinner-3 .icon__spinner{-webkit-animation:spin 1.5s linear infinite;animation:spin 1.5s linear infinite}.icon--ei-sc-facebook{fill:#3b5998}.icon--ei-sc-github{fill:#333}.icon--ei-sc-google-plus{fill:#dd4b39}.icon--ei-sc-instagram{fill:#3f729b}.icon--ei-sc-linkedin{fill:#0976b4}.icon--ei-sc-odnoklassniki{fill:#ed812b}.icon--ei-sc-skype{fill:#00aff0}.icon--ei-sc-soundcloud{fill:#f80}.icon--ei-sc-tumblr{fill:#35465c}.icon--ei-sc-twitter{fill:#55acee}.icon--ei-sc-vimeo{fill:#1ab7ea}.icon--ei-sc-vk{fill:#45668e}.icon--ei-sc-youtube{fill:#e52d27}.icon--ei-sc-pinterest{fill:#bd081c}.icon--ei-sc-telegram{fill:#0088cc}.highlight{margin:0;background:#fff}.highlighter-rouge .highlight{background:#FAFAFA}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{font-weight:bold}.highlight .o{font-weight:bold}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:bold}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:bold;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#aaa}.highlight .gt{color:#a00}.highlight .kc{font-weight:bold}.highlight .kd{font-weight:bold}.highlight .kp{font-weight:bold}.highlight .kr{font-weight:bold}.highlight .kt{color:#458;font-weight:bold}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:#008080}.highlight .nb{color:#0086B3}.highlight .nc{color:#458;font-weight:bold}.highlight .no{color:#008080}.highlight .ni{color:#800080}.highlight .ne{color:#900;font-weight:bold}.highlight .nf{color:#900;font-weight:bold}.highlight .nn{color:#555}.highlight .nt{color:#000080}.highlight .nv{color:#008080}.highlight .ow{font-weight:bold}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#d14}.highlight .sc{color:#d14}.highlight .sd{color:#d14}.highlight .s2{color:#d14}.highlight .se{color:#d14}.highlight .sh{color:#d14}.highlight .si{color:#d14}.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:#008080}.highlight .vg{color:#008080}.highlight .vi{color:#008080}.highlight .il{color:#099}body{color:#323232;font-size:16px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";line-height:27px;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*::selection{color:#fff;background:#00A0FF}a{text-decoration:none;color:#323232;transition:.4s}a:hover,a:active,a:focus{text-decoration:underline}img{display:block;max-width:100%}img[src$='#playdate']{max-width:860px;width:860px;height:540px;margin:25px -90px;border-radius:28px;border:30px solid #322f28;background-color:#b1aea7;image-rendering:auto;image-rendering:crisp-edges;image-rendering:pixelated}@media (max-width: 39.99em){img[src$='#playdate']{width:400px;height:240px;border-radius:0;border:none;margin:25px -40px}}hr{height:1px;margin:32px 0;border:0;background-color:#E9EFF3}h1,h2,h3,h4,h5,h6{font-weight:inherit;line-height:initial;font-weight:600}h1{font-size:36px}h2{font-size:28px}h3{font-size:24px}h4{font-size:20px}h5{font-size:18px}h6{font-size:16px}blockquote{padding-left:16px;border-left:2px solid #99a;color:#99a}pre,code{font-family:Courier,monospace;background-color:#FAFAFA}pre{overflow:auto;padding:32px;margin-bottom:16px;font-size:14px;line-height:22px;white-space:pre-wrap;word-wrap:break-word;word-break:break-all}li code,p code{padding:4px 4px}input[type='text'],input[type='tel'],input[type='number'],input[type='email'],select,textarea{width:100%;padding:16px;border:1px solid #E9EFF3;border-radius:0;outline:none;background-color:#fff;font-size:12px;appearance:none;transition:.4s}input[type='text']:hover,input[type='text']:active,input[type='text']:focus,input[type='tel']:hover,input[type='tel']:active,input[type='tel']:focus,input[type='number']:hover,input[type='number']:active,input[type='number']:focus,input[type='email']:hover,input[type='email']:active,input[type='email']:focus,select:hover,select:active,select:focus,textarea:hover,textarea:active,textarea:focus{border:1px solid #323232}table{width:100%}th{text-align:left;font-weight:normal;color:#99a}.o-grid{margin:0 auto;display:flex;flex-wrap:wrap;max-width:780px}.o-grid:after{content:'';display:table;clear:both}.o-grid .o-grid{margin-right:-16px;margin-left:-16px;padding:0}.o-grid--full{max-width:100vw}.o-grid--final{max-width:100vw;padding:0 16px}.o-grid__col{float:left;padding-right:16px;padding-left:16px}.o-grid__col--1-4-s{width:25%}.o-grid__col--1-3-s{width:33.3333333333%}.o-grid__col--2-4-s{width:50%}.o-grid__col--3-4-s{width:75%}.o-grid__col--4-4-s{width:100%}@media (min-width: 40em){.o-grid__col--1-4-m{width:25%}.o-grid__col--1-3-m{width:33.3333333333%}.o-grid__col--2-4-m{width:50%}.o-grid__col--3-4-m{width:75%}}@media (min-width: 64em){.o-grid__col--1-4-l{width:25%}.o-grid__col--1-3-l{width:33.3333333333%}.o-grid__col--2-4-l{width:50%}.o-grid__col--3-4-l{width:75%}}.o-grid__col--full{width:100%}.o-grid__col--center{margin:0 auto}.o-grid__col--end{margin-left:auto}.o-grid__col--final{padding:0 16px}.o-wrapper{padding:32px 0}.c-off-canvas-container{display:flex;min-height:100vh;flex-direction:column}.c-off-canvas-container .o-wrapper{flex:1 0 auto}.o-plain-list{margin:0;padding:0;list-style:none}.c-header__inner{padding:16px 0;border-bottom:1px solid #E9EFF3}.c-header__icon{vertical-align:middle}.c-logo__link{font-size:24px;transition:.4s}.c-logo__link span{color:silver}.c-logo__link:hover,.c-logo__link:active,.c-logo__link:focus{color:#00A0FF;text-decoration:none}.c-byline{font-size:20px;float:right}.c-byline__desc{color:silver}.c-nav__item{font-size:14px}.c-nav__link{display:block;transition:.4s}.c-nav__link--current{color:#00A0FF}.home-template .c-nav__link--current:not(:hover){color:#323232}.c-nav__link:hover,.c-nav__link:active,.c-nav__link:focus{color:#00A0FF;text-decoration:none}.c-off-canvas-toggle{float:right;position:relative;top:8px;z-index:10;height:19px;width:25px;cursor:pointer}.c-off-canvas-toggle__icon{position:absolute;left:0;height:1px;width:25px;background:#323232;cursor:pointer}.c-off-canvas-toggle__icon:before,.c-off-canvas-toggle__icon:after{content:'';display:block;height:100%;background-color:inherit;transition:.4s}.c-off-canvas-toggle__icon:before{transform:translateY(16px)}.c-off-canvas-toggle__icon:after{transform:translateY(7px)}.c-off-canvas-toggle--close .c-off-canvas-toggle__icon{height:2px;background-color:transparent}.c-off-canvas-toggle--close .c-off-canvas-toggle__icon:before,.c-off-canvas-toggle--close .c-off-canvas-toggle__icon:after{position:relative;visibility:visible;background:#323232}.c-off-canvas-toggle--close .c-off-canvas-toggle__icon:before{top:11px;transform:rotate(-45deg)}.c-off-canvas-toggle--close .c-off-canvas-toggle__icon:after{top:9px;transform:rotate(45deg)}.c-off-canvas-toggle--close{top:0;float:none;display:block;margin-left:auto}html,body{overflow-x:hidden}.c-off-canvas-content{position:fixed;top:0;right:0;width:300px;height:100%;padding:24px 32px;background-color:#fff;transform:translate3d(300px, 0, 0)}.c-off-canvas-container{transform:translate3d(0, 0, 0);transition:transform .4s cubic-bezier(0.16, 0.68, 0.43, 0.99)}.c-off-canvas-container.is-active{transform:translate3d(-300px, 0, 0)}.c-off-canvas-container.is-active:after{position:fixed;top:0;right:0;bottom:0;left:0;content:'';background-color:rgba(0,0,0,0.2)}.c-tags a{display:inline-block;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";line-height:22px;color:#99a;transition:.4s}.c-tags a:hover,.c-tags a:active,.c-tags a:focus{text-decoration:none;background-color:#FAFAFA}@media (max-width: 39.99em){.c-tags{margin-bottom:19px}}.c-comments{margin-bottom:1rem}.c-comments a{display:inline-block;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";line-height:22px;color:#99a;transition:.4s}.c-comments a:hover,.c-comments a:active,.c-comments a:focus{text-decoration:none;background-color:#FAFAFA}@media (max-width: 39.99em){.c-comments{margin-bottom:19px}}.c-btn{display:inline-block;padding:8px 32px;cursor:pointer;transition:.4s;text-align:center;vertical-align:middle;white-space:nowrap;line-height:inherit;border:0;border-radius:0;color:#fff;background-color:#207cdf;font-size:14px}.c-btn:hover,.c-btn:active,.c-btn:focus{text-decoration:none;background-color:#238cf6}.c-btn--full{width:100%}.c-btn--small{padding:4px 16px}.c-post-card{display:block;padding:16px 0;word-break:break-word;border-bottom:1px solid #E9EFF3}.c-post-card .new{font-weight:bold}.c-post-card .fave{font-weight:bold}.c-post-card--first{padding-top:0}.c-post-card--last{padding-bottom:0;border-bottom:0}.c-post-card--post{padding:0}.c-post-card__title{margin-bottom:8px;font-size:16px;font-weight:600;transition:.4s}@media (min-width: 40em){.c-post-card__title{font-size:24px}}.c-post-card__excerpt{margin-bottom:8px}.c-post-card__date{display:block;color:#99a;direction:ltr;font-size:12px;font-weight:600;line-height:19px}.c-post-card:hover{color:#323232;text-decoration:none}.c-post-card:hover .c-post-card__title{color:#00A0FF}.c-pagination{text-transform:uppercase;transition:.4s;margin-top:25px;display:block}.c-pagination:hover,.c-pagination:active,.c-pagination:focus{color:#00A0FF;text-decoration:none}.c-pagination em{font-style:normal;font-weight:bold;text-transform:none}.c-pagination__text{position:relative;font-size:12px;letter-spacing:2px}.c-pagination__text--prev{left:-16px}.c-pagination__text--next{right:-16px}.c-pagination__icon{vertical-align:middle}.c-pagination__icon--prev{left:-8px}.c-pagination__icon--next{right:-8px}.c-post{margin:0 auto;max-width:740px}.c-post__title{font-size:16px;margin-bottom:0}@media (min-width: 40em){.c-post__title{font-size:24px}}.c-post__date{position:relative;padding-top:8px;display:block;margin-bottom:8px;font-size:12px;font-weight:600;line-height:19px;color:#99a}.c-post__date:after{position:absolute;content:'';top:0;left:50%;height:1px;width:64px;background:#FAFAFA;transform:translateX(-50%)}.c-post__image{margin:0 auto 16px}.c-content a:not(.c-btn){text-decoration:underline;text-decoration-skip:ink}.c-content a:not(.c-btn):hover,.c-content a:not(.c-btn):active,.c-content a:not(.c-btn):focus{color:#00A0FF}.twitter-tweet,.fluid-width-video-wrapper{margin-bottom:16px !important}.c-social-nav__item{display:inline-block}.c-social-nav__icon{fill:#323232;vertical-align:middle;transition:.4s}.c-social-nav__icon:hover,.c-social-nav__icon:active,.c-social-nav__icon:focus{fill:#00A0FF}.c-footer{padding:32px 0;background-color:#FAFAFA}.u-hidden{display:none}.u-hidden-visually{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.u-font-medium{font-size:14px;line-height:22px}.u-font-small{font-size:12px;line-height:19px}.u-font-tiny{font-size:10px;line-height:16px}.u-text-left{text-align:left}.u-text-right{text-align:right}.u-text-center{text-align:center}.u-text-justify{text-align:justify}.u-inline{display:inline}.u-block{display:block}.u-inline-block{display:inline-block}.u-left{float:left}.u-right{float:right}.u-clearfix:after{content:'';display:table;clear:both}

  </style>
</head>

<body>

  <div class='js-off-canvas-container c-off-canvas-container'>
    <header class='c-header'>

  <div class='o-grid'>
    <div class='o-grid__col o-grid__col--full'>
      <div class='c-header__inner'>

        <div class='o-grid'>
          <div class='o-grid__col o-grid__col--1-4-s'>
            <div class='c-logo u-text-left'>
              <a class='c-logo__link' href='/' title='Get Info'>
                ⌘I&nbsp;
                <span>Get Info</span>
              </a>
            </div>
          </div>
          <div class='o-grid__col o-grid__col--3-4-s'>
            <div class='c-byline u-text-right'>
              <div class='c-byline__desc'>by&nbsp;<a href="https://www.gingerbeardman.com" class='c-byline__desc'>Matt&nbsp;Sephton</a></div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

</header>

    



<div class='o-wrapper'>
  <div class='o-grid'>
    <div class='o-grid__col--full'>
      <article class='c-post' itemscope itemtype='http://schema.org/BlogPosting'>

        <a href='/' class='c-post-card c-post-card--last c-post-card--post'><h1 class='c-post__title'>Automating interactions using Apple Events</h1></a>

        <time class='c-post__date' datetime='2021-04-19T00:00:00+00:00' itemprop='datePublished'>
          2021-04-19 
          &nbsp;•&nbsp; <span class="reading-time" title="Estimated read time">
  

  
    4 mins
  
  read
</span>

          
          <span class='c-tags'>
            <br>
            
              <a href='/tag/automation'>#automation</a>
            
              <a href='/tag/system7'>#system7</a>
            
              <a href='/tag/emulation'>#emulation</a>
            
              <a href='/tag/macintosh'>#macintosh</a>
            
          </span>
          
        </time>

        <div class='c-content' itemprop='articleBody'>
          

          

          

          <p><a href="/2021/04/17/turning-an-ipad-pro-into-the-ultimate-classic-macintosh/">As I’ve previously mentioned</a>, <em>UltraPaint</em> and <em>artWORKS</em> share a lot of DNA so their structure is effectively identical, including the tool palette. This is a good thing as I intend to automate tool selection in both apps and I’ll take any help 30-year-old software wants to send my way!</p>

<p>Chapter 6 in the book “The Automatic Mac” (1992, <a href="https://vintageapple.org/macbooks/">download</a>) details a number of ways of scripting graphics programs. They use <em>Canvas</em> as an example, which is great because that is a very close relative to the <em>artWORKS</em> and <em>UltraPaint</em> apps that I use. The book informed a lot of what I’m doing here, though my approach differs because of my available tools and personal preference.</p>

<h3 id="simply-clicking">Simply Clicking</h3>

<p>My first thought was to try the naive way of selecting tools by just clicking them! If the tool palettes are positioned in the same place (this can also be automated) then macros can simply click at specific screen locations to select a tool. This approach works well for both apps. But this is a very fragile way of automating interactions—if windows are inadvertently moved the automation will break. So, there’s definitely room for improvement.</p>

<h3 id="going-deeper">Going Deeper</h3>

<p>According to period Apple documentation (<a href="https://www.google.co.uk/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;ved=2ahUKEwiIr_OAzYXwAhXErHEKHR_sAcYQFjAAegQIChAD&amp;url=https%3A%2F%2Fdeveloper.apple.com%2Flegacy%2Flibrary%2Fdocumentation%2Fmac%2Fpdf%2FInterapplication_Communication%2FIntro_to_IAC.pdf&amp;usg=AOvVaw0WKA5J59562fzTuOMZ58PG">PDF</a>, <a href="http://mirror.informatimago.com/next/developer.apple.com/documentation/mac/IAC/IAC-94.html">HTML</a>) a means of automation was introduced in System 7:</p>

<blockquote>
  <p>The <em>interapplication communication</em> (IAC) architecture provides a standard and extensible mechanism for communication among <em>Macintosh</em> applications. The IAC architecture makes it possible for your application to</p>

  <ul>
    <li>provide automated copy and paste operations between your application and other applications</li>
    <li>be manipulated by means of scripts</li>
    <li>send and respond to Apple events</li>
    <li>send and respond to high-level events other than Apple events</li>
    <li>read and write blocks of data between applications</li>
  </ul>
</blockquote>

<p>Sounds perfect—my idea of a good time!</p>

<h3 id="apple-events"><em>Apple Events</em></h3>

<p>To support AppleScript, apps were required to offer suites of supported messages and mechanisms. These are advertised through the <code class="highlighter-rouge">aete</code> resource. <em>ResEdit</em> shows this data as raw hex, unless you install a template to enable it to make sense of it. <em>Resorcerer</em> supports it out of the box. There are a bunch of other tools that can display the data in a human readable way such an Apple-created <a href="https://staticky.com/mirrors/ftp.apple.com/developer/Development_Kits/AppleScript/Development_Tools/Aete_Editor_Stack_1.0b3/"><em>HyperCard</em> stack</a>, a third-party app called <a href="https://macintoshgarden.org/apps/eightyrez"><em>EightyRez</em></a>, and automation tool <a href="https://macintoshgarden.org/apps/quickeys-353"><em>QuicKeys</em></a> to name just a few.</p>

<p><em>QuicKeys</em> sounded ideal as it lets me query the data, using a set of dropdown menus, and use it to specify automation to try out the <em>Apple Events</em> way of selecting a tool. It worked first time! But it was slow, and there was a distracting loss of window focus as the macro was executed.</p>

<p>In search of something better turned to my favourite classic automation tool: <em>KeyQuencer</em>. I’d previously searched trough various archives for any available macros, so had a vague memory there was something out there I might be able to use. I dug up <em>AESend</em>, an <em>Apple Events</em> extension for <em>KeyQuencer</em>.</p>

<p>I used <em>QuicKeys</em> GUI to set up the initial <em>Apple Events</em> call, as it allows you to pick options from drop-down lists. Then I used the <em>Capture AE</em> control panel to decode the <em>Apple Events</em> call into something human readable that I could adapt for use in <em>KeyQuencer</em>. I’d still take that approach for any new <em>Apple Events</em>.</p>

<p>The result was much faster <em>Apple Events</em> sending and no distracting window focus flickering.</p>

<h3 id="two-in-one">Two-in-One</h3>

<p>The end result is a macro of two parts: the first section operates <em>artWORKS</em> using <em>Apple Events</em>, continuing without complaint if the app is not open, and the second section operates <em>UltraPaint</em> via simple mouse clicks.</p>

<p><img src="/images/posts/automating-apple-events.png" alt="PNG" /></p>

<p>I plan to adding support for <em>Canvas</em> 3.x at some point as this shares <em>Apple Events</em> support with <em>artWORKS</em>.</p>

<h3 id="investigation">Investigation</h3>

<p>According to the <code class="highlighter-rouge">aete</code> resource description in both <em>artWORKS</em> and <em>Canvas</em>, selection of Internal Tools using <em>Apple Events</em> is limited to 10 seemingly random tools. This made no sense to me, so I tried specifying higher tools and this experimentation proved that all 18 internal tools are indeed available. I guess the description had been truncated at some point?</p>

<p>Some time later I read “The Automatic Mac” again and it shows a more complete list of tool values! The order seems to be based on the tool palette in <em>Canvas</em>.</p>

<p>Even so, I went the extra mile to complete a list of both internal and external tools, shown below.</p>

<h4 id="internal-tools-btol">Internal Tools (btol)</h4>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>shor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ArcRect</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Arrow</td>
      <td>1</td>
    </tr>
    <tr>
      <td>BezierCurve</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Brush</td>
      <td>14</td>
    </tr>
    <tr>
      <td>Eraser</td>
      <td>17</td>
    </tr>
    <tr>
      <td>Free Hand</td>
      <td>8</td>
    </tr>
    <tr>
      <td>Lasso</td>
      <td>11</td>
    </tr>
    <tr>
      <td>Line</td>
      <td>3</td>
    </tr>
    <tr>
      <td>Marquee</td>
      <td>12</td>
    </tr>
    <tr>
      <td>Oval</td>
      <td>6</td>
    </tr>
    <tr>
      <td>Paint Bucket</td>
      <td>15</td>
    </tr>
    <tr>
      <td>Paint Object Creator</td>
      <td>18</td>
    </tr>
    <tr>
      <td>Pencil</td>
      <td>16</td>
    </tr>
    <tr>
      <td>Polygon</td>
      <td>9</td>
    </tr>
    <tr>
      <td>Rect</td>
      <td>4</td>
    </tr>
    <tr>
      <td>RoundRect</td>
      <td>5</td>
    </tr>
    <tr>
      <td>Spray Can</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Text</td>
      <td>2</td>
    </tr>
  </tbody>
</table>

<h4 id="external-tools-etol">External Tools (etol)</h4>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>long</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Coil</td>
      <td>CoiL</td>
    </tr>
    <tr>
      <td>Concentric Circles</td>
      <td>CCir</td>
    </tr>
    <tr>
      <td>Cube</td>
      <td>Cube</td>
    </tr>
    <tr>
      <td>Cylinder</td>
      <td>cyln</td>
    </tr>
    <tr>
      <td>Dimensioning</td>
      <td>DIMN</td>
    </tr>
    <tr>
      <td>Doughnuts</td>
      <td>doug</td>
    </tr>
    <tr>
      <td>Fractals</td>
      <td>Flin</td>
    </tr>
    <tr>
      <td>Gradient Fill</td>
      <td>ObFl</td>
    </tr>
    <tr>
      <td>GridMaker</td>
      <td>grid</td>
    </tr>
    <tr>
      <td>Mover</td>
      <td>MovE</td>
    </tr>
    <tr>
      <td>Multigon</td>
      <td>NGON</td>
    </tr>
    <tr>
      <td>Namestamp</td>
      <td>NamE</td>
    </tr>
    <tr>
      <td>Parallel Lines</td>
      <td>Paln</td>
    </tr>
    <tr>
      <td>Point Rotate</td>
      <td>PtRt</td>
    </tr>
    <tr>
      <td>QuickTime</td>
      <td>QkTm</td>
    </tr>
    <tr>
      <td>Registration Marks</td>
      <td>regP</td>
    </tr>
    <tr>
      <td>Resistor</td>
      <td>ResT</td>
    </tr>
    <tr>
      <td>Sounder</td>
      <td>sndT</td>
    </tr>
    <tr>
      <td>Spiral</td>
      <td>Spir</td>
    </tr>
    <tr>
      <td>Split</td>
      <td>Splt</td>
    </tr>
    <tr>
      <td>Star</td>
      <td>STAR</td>
    </tr>
    <tr>
      <td>Timestamp</td>
      <td>TimE</td>
    </tr>
  </tbody>
</table>

        </div>



        

      </article>
    </div>
  </div>

  <div class='o-grid'>
    
  <div class='o-grid__col o-grid__col--2-4-s'>
    <a class='c-pagination' href='/2021/04/17/turning-an-ipad-pro-into-the-ultimate-classic-macintosh/'>
      <div class='c-pagination__icon c-pagination__icon--prev' data-icon='ei-chevron-left'></div>
      <span class='c-pagination__text c-pagination__text--prev'>Previous Post</span>
      <br>
      <em>Turning an iPad Pro into the Ultimate Classic Macintosh</em>
    </a>
  </div>




  </div>
</div>


    <footer class='c-footer'>
  <div class='o-grid'>
    <div class='o-grid__col o-grid__col--full'>
      
    </div>
  </div>
</footer>

  </div>

  <script src="/js/jquery-3.1.1.min.js"> </script>
  <script src="/js/evil-icons.min.js">   </script>
  <script src="/js/jquery.fitvids.js">   </script>
  <script src="/js/app.js">              </script>
</body>

</html>